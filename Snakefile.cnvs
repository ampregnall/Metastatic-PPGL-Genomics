configfile: "config.yaml"

rule all:
    input:
        annotSV = "data/processed/cnvs/annotSV/mPPGL.annotSV.data.combined.txt",
        changes = "data/processed/cnvs/arm_level_changes/mPPGL_arm_level_statistics.txt",
        summary = "data/processed/cnvs/arm_level_changes/mPPGL_arm_level_summary.txt"
    
rule calculate_arm_level_changes:
    input: 
        data = "data/processed/cnvs/annotSV/mPPGL.annotSV.data.combined.txt",
        cytos = "metadata/GrCh38.arm.coordinates.txt",
        ploidy = "metadata/Sequenza-Ploidy-Estimates.xlsx"
    output:
        changes = "data/processed/cnvs/arm_level_changes/mPPGL_arm_level_statistics.txt",
        summary = "data/processed/cnvs/arm_level_changes/mPPGL_arm_level_summary.txt"
    shell: "Rscript src/cnv_analysis/calculate_arm_level_changes.R --input={input.data} --cytobands={input.cytos} --ploidy={input.ploidy} "
        "--output={output.changes} --summary={output.summary}"

rule combine_annotSV:
    input: "data/raw/cnvs/annotSV"
    output: "data/processed/cnvs/annotSV/mPPGL.annotSV.data.combined.txt"
    shell: "python src/utilities/combine_files.py -i={input} -o={output}"